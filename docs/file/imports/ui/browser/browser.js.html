<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../">
  <title data-ice="title">imports/ui/browser/browser.js | genebook</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="A portable website for browsing and querying genome sequences and annotations"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="genebook"><meta property="twitter:description" content="A portable website for browsing and querying genome sequences and annotations"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/holmrenser/genebook"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#api-blast">api/blast</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-hasBlastDb">hasBlastDb</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-makeBlastDb">makeBlastDb</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-removeBlastDb">removeBlastDb</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-submitBlastJob">submitBlastJob</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#api-downloads">api/downloads</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Downloads">Downloads</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#api-genes">api/genes</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-addInterproscan">addInterproscan</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-addOrthogroupTrees">addOrthogroupTrees</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Attributes">Attributes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Downloads">Downloads</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-downloadGenes">downloadGenes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EditHistory">EditHistory</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-GeneSchema">GeneSchema</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Genes">Genes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SubfeatureSchema">SubfeatureSchema</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Interpro">Interpro</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Orthogroups">Orthogroups</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-scanGeneAttributes">scanGeneAttributes</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#api-genomes">api/genomes</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-addGff">addGff</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-addReference">addReference</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ReferenceInfo">ReferenceInfo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ReferenceInfoSchema">ReferenceInfoSchema</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ReferenceSchema">ReferenceSchema</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-References">References</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Tracks">Tracks</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-trackSchema">trackSchema</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-updateTrackPermissions">updateTrackPermissions</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#api-transcriptomes">api/transcriptomes</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ExperimentInfo">ExperimentInfo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ExperimentInfoSchema">ExperimentInfoSchema</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-TranscriptomeSchema">TranscriptomeSchema</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Transcriptomes">Transcriptomes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-updateSampleInfo">updateSampleInfo</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#api-users">api/users</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-updateUserInfo">updateUserInfo</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#api-util">api/util</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-formatAttributes">formatAttributes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getGeneSequences">getGeneSequences</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-parseNewick">parseNewick</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-reverseComplement">reverseComplement</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-translate">translate</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#ui-admin">ui/admin</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-JobProgressBar">JobProgressBar</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#ui-admin-tracks">ui/admin/tracks</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/imports/ui/admin/tracks/TrackPermissionSelect.jsx~TrackPermissionSelect.html">TrackPermissionSelect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-AdminTrackInfo">AdminTrackInfo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-BlastDatabaseButtons">BlastDatabaseButtons</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-BlastDatabaseProgressBar">BlastDatabaseProgressBar</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#ui-admin-transcriptomes">ui/admin/transcriptomes</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/imports/ui/admin/transcriptomes/ExperimentGroup.jsx~ExperimentGroup.html">ExperimentGroup</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/imports/ui/admin/transcriptomes/SampleInfo.jsx~SampleInfo.html">SampleInfo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/imports/ui/admin/transcriptomes/TrackExperiments.jsx~TrackExperiments.html">TrackExperiments</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#ui-blast">ui/blast</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/imports/ui/blast/BlastResultList.jsx~BlastResultList.html">BlastResultList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/imports/ui/blast/BlastResultPlot.jsx~BlastResultPlot.html">BlastResultPlot</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#ui-feature">ui/feature</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/imports/ui/feature/ProteinDomains.jsx~ProteinDomains.html">ProteinDomains</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/imports/ui/feature/Seq.jsx~SeqContainer.html">SeqContainer</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#ui-genelist">ui/genelist</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/imports/ui/genelist/AttributeSelect.jsx~AttributeSelect.html">AttributeSelect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/imports/ui/genelist/GeneTableCard.jsx~GeneTableCard.html">GeneTableCard</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/imports/ui/genelist/GeneTableOptions.jsx~GeneTableOptions.html">GeneTableOptions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ThreewayRadioButtons">ThreewayRadioButtons</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-TrackSelect">TrackSelect</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#ui-genelist-downloads">ui/genelist/downloads</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/imports/ui/genelist/downloads/DownloadDialog.jsx~DownloadDialogModal.html">DownloadDialogModal</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#ui-landingpage">ui/landingpage</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/imports/ui/landingpage/Landingpage.jsx~Landingpage.html">Landingpage</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#ui-main">ui/main</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/imports/ui/main/MainLayout.jsx~MainLayout.html">MainLayout</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-InactiveAccountWarning">InactiveAccountWarning</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-NotFound">NotFound</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#ui-util">ui/util</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Loading">Loading</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isLoading">isLoading</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-withEither">withEither</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">imports/ui/browser/browser.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import { Meteor } from &apos;meteor/meteor&apos;;
import { Session } from &apos;meteor/session&apos;;
import { Template } from &apos;meteor/template&apos;;
import { Tracker } from &apos;meteor/tracker&apos;;

import &apos;./browser.html&apos;;
import &apos;./browser.scss&apos;;


Session.setDefault(&apos;seqid&apos;,&apos;PanWU01x14_asm01_scf00001&apos;);
Session.setDefault(&apos;start&apos;,409500);
Session.setDefault(&apos;end&apos;,413500);
Session.setDefault(&apos;track&apos;,&apos;PanWU01x14_asm01_ann01&apos;)
Tracker.autorun(function(){
	var track = Session.get(&apos;track&apos;)
	var seqid = Session.get(&apos;seqid&apos;);
	var start = Session.get(&apos;start&apos;);
	var end = Session.get(&apos;end&apos;);
	var zoom = (end - start) / 4;
  Meteor.subscribe(&apos;browser&apos;,track,seqid,start-zoom,end+zoom);
})

Template.browser.helpers({
	genes : function(){
	},
	start: function(){
		return Session.get(&apos;start&apos;)
	},
	end: function(){
		return Session.get(&apos;end&apos;)
	},
	seqid: function(){
		return Session.get(&apos;seqid&apos;)
	},
	track: function(){
		return Session.get(&apos;track&apos;)
	}
});

Template.browser.events({
	&quot;submit .new-seqid&quot;: function(event){
		event.preventDefault();
		var seqid = event.target.seqid.value;
		Session.set(&apos;seqid&apos;,seqid);
	},
	&quot;submit .new-start&quot;: function(event){
		event.preventDefault();
		var start = parseInt(event.target.start.value);
		Session.set(&apos;start&apos;,start);
	},
	&quot;submit .new-end&quot;: function(event){
		event.preventDefault();
		var end = parseInt(event.target.end.value);
		Session.set(&apos;end&apos;,end);
	},
	&quot;click .nav#min&quot;: function(){
		console.log(&apos;min&apos;);
		var curStart = Session.get(&apos;start&apos;);
		var curEnd = Session.get(&apos;end&apos;);
		var zoom = Math.floor((curEnd - curStart) / 4)
		var newStart = curStart - zoom &gt; 0 ? curStart - zoom : 0;
		var newEnd = curEnd + zoom;
		Session.set(&apos;start&apos;,newStart);
		Session.set(&apos;end&apos;,newEnd);
	},
	&quot;click .nav#plus&quot;: function(){
		console.log(&apos;plus&apos;);
		var curStart = Session.get(&apos;start&apos;);
		var curEnd = Session.get(&apos;end&apos;);
		var zoom = Math.floor((curEnd - curStart) / 8)
		var newStart = curStart + zoom &gt; 0 ? curStart + zoom : 0;
		var newEnd = curEnd - zoom;
		Session.set(&apos;start&apos;,newStart);
		Session.set(&apos;end&apos;,newEnd);
	},
	&quot;click .nav#left&quot;: function(){
		console.log(&apos;left&apos;);
		var curStart = Session.get(&apos;start&apos;);
		var curEnd = Session.get(&apos;end&apos;);
		var zoom =Math.floor((curEnd - curStart) / 4)
		var newStart = curStart - zoom &gt; 0 ? curStart - zoom : 0;
		var newEnd = curStart - zoom &gt; 0 ? curEnd - zoom : zoom * 2;
		Session.set(&apos;start&apos;,newStart);
		Session.set(&apos;end&apos;,newEnd);
	},
	&quot;click .nav#right&quot;: function(){
		console.log(&apos;right&apos;);
		var curStart = Session.get(&apos;start&apos;);
		var curEnd = Session.get(&apos;end&apos;);
		var zoom = Math.floor((curEnd - curStart) / 4)
		var newStart = curStart + zoom;
		var newEnd = curEnd + zoom;
		Session.set(&apos;start&apos;,newStart);
		Session.set(&apos;end&apos;,newEnd);
	}
});

Template.browser.onRendered(function(){
    function isOverlapping(x1,x2,y1,y2){
    	if (x1 &gt;= y1 &amp;&amp; x1 &lt;= y2){
    		console.log(&apos;this&apos;)
    		return true
    	} else if (y1 &gt;= x1 &amp;&amp; y1 &lt;= x2){
    		console.log(&apos;that&apos;)
    		return true
    	} else {
    		return false
    	}
    	//return (x2 &gt;= y1 &amp;&amp; x1 &lt;= y2)
    	//return Math.max(x1,y1) &lt;= Math.min(y1,y2)
    }
    function setVerticalPosition(genes,subsMap){
    	var processed = [];
    	for (var i = 0;i &lt; genes.length;i++){
    		if (_.contains(processed,i)){
    			console.log(&apos;contains&apos;)
    			continue
    		};
    		//if (!_.has(genes[i],&apos;placement&apos;)){
    			genes[i].placement = 1
    		//};
    		for (var j = 0;j &lt; genes.length;j++){
    			if (i &gt;= j) { 
    				continue 
    			};
    			var gene1 = genes[i]
    			var gene2 = genes[j]
    			var overlap = isOverlapping(gene1.start,gene1.end,gene2.start,gene2.end)
    			console.log(i,j)
    			console.log(overlap,gene1.ID,gene2.ID)
    			if (overlap){
    				processed.push(j)
    				var placement = genes[i].placement + 1
    				genes[j].placement = placement
    				for (sub in genes[j].children){
    					subId = genes[j].children[sub]
    					//console.log(subId)
    					if (Object.keys(subsMap).indexOf(subId) &gt; 0){
    						subsMap[subId].placement = placement
    					}
    				}
    				console.log(&apos;overlap&apos;,gene1.ID,gene2.ID)
    			}
    		}
    	}
    }
    function getSubsMap(subs){
    	var subsMap = {}
    	for (var sub in subs){
    		var subId = subs[sub].ID
    		subsMap[subId] = subs[sub]
    	}
    	//for (var i = 0;i &lt; subs.length;i++){
    	//	var sub = subs[i]
    	//	subsMap[sub.ID] = sub
    	//}
    	return subsMap
    }
    /*
    var tip = d3.tip()
			.attr(&apos;class&apos;, &apos;d3-tip&apos;)
			.offset([140, 0])
			.html(function(d) {
				var text = &quot;&lt;p&gt;&lt;strong&gt;ID:&lt;/strong&gt; &lt;span&gt;&quot; + d.ID + &quot;&lt;/span&gt;&lt;/p&gt;&quot;;
				text += &quot;&lt;p&gt;&lt;strong&gt;pos:&lt;/strong&gt; &lt;span&gt;&quot; + d.placement + &quot;&lt;/span&gt;&lt;/p&gt;&quot;;
				return text;
			})
	*/
	//select container and make svg element
	//select the div to plot in, set min max and margins
	var vis = this.find(&apos;.browser&apos;);
	var margin = {top: 5, right: 25, bottom: 0, left: 10};
    var width = $(&apos;.browser&apos;).width() - margin.left - margin.right;
    var height = 200 - margin.top - margin.bottom;

    var container = d3.select(vis).append(&apos;svg&apos;)
		.attr(&apos;height&apos;,height + margin.top + margin.bottom)
		.attr(&apos;width&apos;,width + margin.left + margin.right)
		.attr(&apos;transform&apos;,&apos;translate(&apos;+margin.left+&apos;,&apos;+margin.top+&apos;)&apos;)
	
	//container.call(tip);

	Tracker.autorun(function(){
		var track = Session.get(&apos;track&apos;)
		var seqid = Session.get(&apos;seqid&apos;);
		var start = Session.get(&apos;start&apos;);
		var end = Session.get(&apos;end&apos;);
		var zoom = (end - start) / 2;
		var maxZoom = 100000;
		var subs = Genes.find({&apos;type&apos;:&apos;CDS&apos;,&apos;track&apos;:track,&apos;seqid&apos;:seqid,&apos;end&apos;:{$gte:start - zoom},&apos;start&apos;:{$lte:end + zoom}}).fetch();
		var genes = Genes.find({&apos;type&apos;:&apos;mRNA&apos;,&apos;track&apos;:track,&apos;seqid&apos;:seqid,&apos;end&apos;:{$gte:start - zoom},&apos;start&apos;:{$lte:end + zoom}}).fetch();
		var subsMap = getSubsMap(subs);
		setVerticalPosition(genes,subsMap);
		var _genes = genes.map(function(x){ return [x.ID,x.placement] } )
		//console.log(_genes);
		//setup x scale 
		var xScale = d3.scale.linear()
			.domain([start,end])
			.range([0,width])

		var track = container.append(&apos;g&apos;)
			.attr(&apos;class&apos;,&apos;track&apos;)
			.attr(&apos;transform&apos;,&apos;translate(0,40)&apos;)

		//plot backbone line
		var lines = container.select(&apos;g.track&apos;)
			.selectAll(&apos;line&apos;)
			.data(function(){
				if (zoom &lt;= maxZoom){
					return genes
				} else {
					return [];
				}
			})

		lines.enter()
			.append(&apos;line&apos;)
			.style(&apos;stroke&apos;,&apos;black&apos;)
			.attr(&apos;y1&apos;,function(d){ return (d.placement * 10) - 5})
			.attr(&apos;y2&apos;,function(d){ return (d.placement * 10) - 5})
		lines.transition()
			.duration(2000)
			.attr(&apos;x1&apos;,function(d){ 
			//console.log(d.placement)
			return xScale(d.start) 
		})
			.attr(&apos;x2&apos;,function(d){ return xScale(d.end) })
		//plot exon rectangles
	    var exons = container.select(&apos;g.track&apos;)
	    	.selectAll(&apos;rect&apos;)
	    	.data(function(){
	    		if (zoom &lt;= maxZoom){
	    			return subs
	    		} else {
	    			return genes
	    		}
	    	})
	    exons.transition()
			.duration(200)
			.attr(&apos;x&apos;,function(d){ return xScale(d.start) })
			.attr(&apos;y&apos;,function(d){
				if (d.placement === undefined){
					return 0
				} else {
					return (d.placement) * 10
				}
			})
			.attr(&apos;width&apos;,function(d){ return xScale(d.end) - xScale(d.start) })

	    exons.enter()
			.append(&apos;rect&apos;)
		
		exons.exit().remove()
		exons.attr(&apos;x&apos;,function(d){ return xScale(d.start) })
			.attr(&apos;y&apos;,function(d){
				if (d.placement === undefined){
					return 0
				} else {
					return (d.placement) * 10
				}
			})
			.attr(&apos;width&apos;,function(d){ return xScale(d.end) - xScale(d.start) })
			.attr(&apos;height&apos;,10)
			.style(&apos;fill&apos;,function(d){
				if (d.strand === &apos;+&apos;){
					return &apos;red&apos;;
				} else {
					return &apos;blue&apos;;
				}
			})

	    var xAxis = d3.svg.axis()
			.tickFormat(d3.format(&apos;d&apos;))
			.orient(&apos;top&apos;)
			.scale(xScale);

	    var xAxisGroup = container.append(&apos;g&apos;)
			.attr(&apos;class&apos;,&apos;x axis&apos;)
			//.attr(&apos;transform&apos;,&apos;translate(0,&apos;+height+&apos;)&apos;)
			.attr(&apos;transform&apos;,&apos;translate(0,20)&apos;)
			.selectAll(&apos;text&apos;)
			.style(&apos;text-anchor&apos;,&apos;start&apos;)
			.transition()
		
		container.select(&apos;g.x.axis&apos;).call(xAxis)
			
    })
});</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.0.4)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
